<!--<!DOCTYPE html>-->
<html>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Poremo | Report</title>
	<meta name="description" content="Poremo from Telkom Property"/>
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-lite/1.3.0/material.red-purple.min.css"/>
	<!-- <link rel="stylesheet" type="text/css" href="assets/css/mdl-ext-eqjs.min.css"> -->
	<link rel="stylesheet" type="text/css" href="assets/css/jquery.accordion.css">
	<link rel="stylesheet" type="text/css" href="assets/css/dialog-polyfill.css" />
	<!-- <link rel="stylesheet" href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.css">
	<link rel="stylesheet" href="https://unpkg.com/filepond/dist/filepond.min.css"> -->
	<link rel="stylesheet" type="text/css" href="assets/css/main.css">
	<link rel="manifest" href="manifest.json"> 
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-title" content="Poremo">
	<link rel="apple-touch-icon" href="assets/images/icons/apple-icon-57x57.png" sizes="57x57">
	<link rel="apple-touch-icon" href="assets/images/icons/apple-icon-60x60.png" sizes="60x60">
	<link rel="apple-touch-icon" href="assets/images/icons/apple-icon-72x72.png" sizes="72x72">
	<link rel="apple-touch-icon" href="assets/images/icons/apple-icon-76x76.png" sizes="76x76">
	<link rel="apple-touch-icon" href="assets/images/icons/apple-icon-120x120.png" sizes="120x120">
	<link rel="apple-touch-icon" href="assets/images/icons/apple-icon-144x144.png" sizes="144x144">
	<link rel="apple-touch-icon" href="assets/images/icons/apple-icon-180x180.png" sizes="180x180">
	<meta name="msapplication-TileImage" content="assets/images/icons/app-144x144.png">
	<meta name="msapplication-TileColor" content="#fff">
	<meta name="theme-color" content="#f5554a">
</head>
<body>
	<!--Header Input data-->
	<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
	<header class="mdl-layout__header">
		<div class="mdl-layout__header-row">
			<a href="report.html" title=""><i id="arrow-back" class="material-icons">arrow_back</i></a>
			<span class="mdl-layout-title" id="title-nav__style">Update Report</span>
		</div>
	</header><!-- /header -->	
	<main class="mdl-layout__content">
		<div class="page-content">
			<div class="site-content">
				<div class="container">
					<div id="input-project" class="mdl-grid site-max-width">
						<div class="mdl-cell mdl-cell--12-col mdl-card mdl-shadow--4dp page-content">
							<!-- <div class="location-desc mdl-card__title">
								<h1 class="mdl-card__title-text"><i class="material-icons">location_on</i> Makassar</h1>
							</div> -->
							<div class="mdl-card__title">
								<h1 id="titleSub" class="title-boq mdl-card__title-text"></h1>
							</div>
							
							<div class="mdl-grid site-next">
								<div class="mdl-cell mdl-cell--12-col">
								  <form id="update-report-item">
									<section id="only-one" data-accordion-group>
								      <!-- <section data-accordion>
								        <header data-control class="mdl-card__title mdl-color--primary mdl-color-text--primary-contrast">
								        	
								        	<h4 class="title-sub__project mdl-card__title-text"><span class="no-sub__project">SS101-1 </span>  Gudang Luas 210 m2</h4>
								        </header>
								        <div data-content="">
								          <div data-accordion>
								            <header data-control class="mdl-card__title mdl-color--accent mdl-color-text--primary-contrast">
								        		<h4 class="title-list-sub__project mdl-card__title-text"><span class="no-list-sub__project">2.</span> Pengukuran dan pasang Bowplank</h4>
								        	</header>
								            <div data-content>
											  <div class="action mdl-card__actions mdl-card--border">
											    <a onclick="update(1)" class="show-dialog mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--primary">
											      Update
											    </a>
											    <div style="float: right;">
											    	<button type="button" class="percentage-show mdl-button mdl-button--colored mdl-js-button">
											      	<span id="persentase_item_">20</span>%
											    	</button>
											    	<a href="picture-progress_boq.html" type="button" class="mdl-button mdl-button--icon mdl-button--colored mdl-js-button"><i class="material-icons">photo_library</i>
											    	</a>
											    </div>
											  </div>
								            </div>
								          </div>
								        </div>
								      </section> -->
								    </section>

								    <div id="submit-button" style="float: right;">
								    	<button id="submit-report" type="submit" style="margin: 5px;" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--primary">Submit
								    	</button>
								    	<button onclick="window.location.href= 'report.html'" type="button" id="cancel_btn" style="margin: 5px;" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">Cancel
								    	</button>
								    </div>
								    
								  </form> 
								</div>
								<!--<div id='coba-data'></div>-->
								<!--<div class="mdl-cell mdl-cell--12-col">-->
								<!--	<input id="upload-pdf" type="file" name="upload" accept="application/pdf" />-->
								<!--</div>-->
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
	</main>
	<dialog class="mdl-dialog">
		<h4 class="mdl-dialog__title">Pemutakhiran</h4>
		<div class="mdl-dialog__content">
			<form id="dialog-form">
				<!-- <button onclick="tambahPersen()" style="margin: auto;" type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--primary">Tambah Persen</button><br> -->
				<div id="persentase-progress" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
					<input class="mdl-textfield__input" type="tel" name="percentage" id="percentage">
					<label class="mdl-textfield__label" for="percentage">Bobot Progress</label>
				</div>
				<div id="bobot-report" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
					<input disabled class="mdl-textfield__input" type="tel" name="weight" id="weight">
					<label class="mdl-textfield__label" for="weight">Bobot Boq Item</label>
				</div>

			  	<div id="input-lokasiKota" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
				    <input class="mdl-textfield__input" type="text" name="city" id="city" pattern="[A-Za-z ]+">
					<label class="mdl-textfield__label" for="city">Lokasi</label>
					<span class="mdl-textfield__error">Lokasi hanya boleh huruf</span>
			  	</div>
			  	<div id="id_address" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
				    <textarea class="mdl-textfield__input" type="text" rows="5" name="address" id="address"></textarea>
				    <label class="mdl-textfield__label" for="address">Alamat</label>
			  	</div>
			  	<input style="display: none;" type="text" id="coord_x" name="coord_x">
				<input style="display: none;" type="text" id="coord_y" name="coord_y">
			  	<button type="button" id="get-location__input" class="mdl-button mdl-js-button mdl-js-ripple-effect">
				  Get Location
				</button>
				<button type="button" id="allow-location__input" class="mdl-button mdl-js-button mdl-js-ripple-effect">
					Allow Location
				</button>
				<div class="mdl-spinner mdl-js-spinner is-active" id="location-loader"></div>

				<!-- <input type="number" id="report_item_id" name="report_item_id" value=""> -->
				<span class="btn btn-success fileinput-button">
	            	<label id="inputFiles" for="file">Masukkan Gambar</label>
	            	<input style="display: none" type="file" id="file" multiple accept="image/*">
	            	<br />
	        	</span>

	        	<!-- <input type="file" 
	        	       class="filepond"
	        	       name="filepond"
	        	       multiple
	        	       data-max-file-size="3MB"
	        	       data-max-files="3" /> -->
	        	<!-- <input type="file" id="file" name="files[]" accept="image/jpeg, image/png," multiple > -->
	        	<output id="Filelist"></output>

	        	<!-- <input type="file" id="file" multiple />
	        	    <p id="img"></p>
	        	    <p id="datadata"></p> -->
				<br><br>

			
		</div>
		<div class="mdl-dialog__actions">
			<button type="submit" id="submitBtn" class="mdl-button">Membarui</button>
			<div class="mdl-spinner mdl-js-spinner is-active" id="location-loaders"></div>
			<button type="reset" class="mdl-button mdl-button--colored close">Batal</button>
		</div>
	</form>
	</dialog>

	<dialog class="dialog-Update mdl-dialog">
		<h4 class="mdl-dialog__title">Update Report Item</h4>
		<div class="mdl-dialog__content">
				
			<p>Berhasil men-Update Report Item</p>		
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="ok-Update mdl-button mdl-button--colored">Ok</button>
			
		</div>
	
	</dialog>

	<dialog class="dialog-Fail mdl-dialog">
		<h4 class="mdl-dialog__title">Photo Over Capacity</h4>
		<div class="mdl-dialog__content">
				
			<p>Foto yang diupload tidak boleh lebih dari 5 foto. Hapus sebagian untuk melanjutkan</p>		
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="ok-Fail mdl-button mdl-button--colored">Ok</button>
			
		</div>
	
	</dialog>

	<dialog class="dialog-FailPercent mdl-dialog">
		<h4 class="mdl-dialog__title">Persentase Berlebih</h4>
		<div class="mdl-dialog__content">
				
			<p>Nilai Persentase Progress Harus sama atau lebih kecil dari nilai Bobot</p>		
		</div>
		<div class="mdl-dialog__actions">
			<button type="button" class="ok-FailPercent mdl-button mdl-button--colored">Ok</button>
			
		</div>
	
	</dialog>
	
	</div>
<!-- <script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script> -->
<script src="assets/js/material.min.js"></script>
<!-- <script src="assets/js/eq.min.js" type="text/javascript" charset="utf-8"></script>
<script src="assets/js/dialog-polyfill.js" type="text/javascript" charset="utf-8"></script>
<script src="assets/js/mdl-ext.min.js" type="text/javascript" charset="utf-8"></script>
 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="assets/js/dialog-polyfill.js" type="text/javascript" charset="utf-8"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.accordion.js"></script>
<!-- <script src="https://unpkg.com/filepond-plugin-file-encode/dist/filepond-plugin-file-encode.min.js"></script>
<script src="https://unpkg.com/filepond-plugin-file-validate-size/dist/filepond-plugin-file-validate-size.min.js"></script>
<script src="https://unpkg.com/filepond-plugin-image-exif-orientation/dist/filepond-plugin-image-exif-orientation.min.js"></script>
<script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.js"></script>
<script src="https://unpkg.com/filepond-plugin-image-transform/dist/filepond-plugin-image-transform.min.js"></script>
<script src="https://unpkg.com/filepond-plugin-image-resize/dist/filepond-plugin-image-resize.min.js"></script>
<script src="https://unpkg.com/filepond-plugin-image-crop/dist/filepond-plugin-image-crop.min.js"></script>
<script src="https://unpkg.com/filepond/dist/filepond.min.js"></script>
<script>

</script> -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;sensor=false&amp;language=in&amp;key=AIzaSyDCNUdU1WdGoMyebHJ-g3qTxwSaaa0ynKI"></script>

  <!-- <script type="text/javascript">
  	localStorage.setItem('project_id', 2)
  	var latest_reference_number = 999;
  	var current_reference_number = latest_reference_number + 1;
  	// var digit = (reference_number / 10);
  	// // alert(digit)
  	var str = current_reference_number;
  	if(current_reference_number<10){
  		str = '000' + current_reference_number;
  	} else if (current_reference_number <100){
  		str = '00' + current_reference_number;
  	} else if (current_reference_number <1000) {
  		str = '0'+ current_reference_number;
  	}
  	reference_number = 'S' + current_reference_number;

  	// switch(digit){
  	// 	case 1 :
  	// 	str = '000' + reference_number;
  	// 	break;
  	// 	case 2:
  	// 	str = '00' + reference_number;
  	// 	break;
  	// 	case 3:
  	// 	str = '0' + reference_number;
  	// 	break;
  	// 	default:
  	// // 	break;
  	// }
  	alert(str);
  </script> -->
<script src="assets/js/promise.js"></script>
<script src="assets/js/fetch.js"></script>
<script src="assets/js/idb.js"></script>
<script src="assets/js/utility.js"></script>
<script src="assets/js/geolocation.js"></script>
<script src="assets/js/updateReport.js"></script>
<script>
	$(document).ready(function () {
        $('#file').change(function () {
            if (this.files.length > 0) {

                $.each(this.files, function (i, v) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        var img = new Image();
                        img.src = e.target.result;

                        img.onload = function () {

                            // CREATE A CANVAS ELEMENT AND ASSIGN THE IMAGES TO IT.
                            var canvas = document.createElement("canvas");

                            var value = 30;

                            // RESIZE THE IMAGES ONE BY ONE.
                            img.width = (img.width * value) / 100
                            img.height = (img.height * value) / 100

                            var ctx = canvas.getContext("2d");
                            ctx.clearRect(0, 0, canvas.width, canvas.height);
                            canvas.width = img.width;
                            canvas.height = img.height;
                            ctx.drawImage(img, 0, 0, img.width, img.height);

                            // $('#img').append(img);      // SHOW THE IMAGES OF THE BROWSER.
                            var ul = document.createElement('ul');
                            ul.className = ("thumb-Images");
                            ul.id = "imgList";

                            var li = document.createElement('li');
                            ul.appendChild(li);
                            li.innerHTML = ['<div class="img-wrap"> <span class="close">&times;</span>' +
                                '<img class="thumb" src="', canvas.toDataURL("image/jpeg"), '"/>' + '</div>'].join('');

                            
                            document.getElementById('Filelist').insertBefore(ul, null); 


                            // AUTO DOWNLOAD THE IMAGES, ONCES RESIZED.
                            // var a = document.createElement('img');
                            // a.classList.add('imgPhoto');
                            // a.setAttribute('style', 'width:100%;height:auto;');
                            // var datadata = document.querySelector("#datadata");
                            // a.src = canvas.toDataURL("image/jpeg");
                            // $('#datadata').append(a);
                            
                        }
                    };
                    reader.readAsDataURL(this);
                });
            }
        });

        $('div').on('click', '.img-wrap .close', function () {
            // var id = $(this).closest('.img-wrap').find('img').data('id');

            // //to remove the deleted item from array
            // var elementPos = AttachmentArray.map(function (x) { return x.FileName; }).indexOf(id);
            // if (elementPos !== -1) {
            //     AttachmentArray.splice(elementPos, 1);
            // }

            //to remove image tag
            $(this).parent().find('img').not().remove();

            //to remove div tag that contain the image
            $(this).parent().find('div').not().remove();

            //to remove div tag that contain caption name
            $(this).parent().parent().find('div').not().remove();

            //to remove li tag
            var lis = document.querySelectorAll('#imgList li');
            for (var i = 0; li = lis[i]; i++) {
                if (li.innerHTML == "") {
                    li.parentNode.removeChild(li);
                }
            }

            $('#file').val('');

        });
    });
</script>
<!-- <script src="assets/js/picUpload.js"></script> -->
<script src="assets/js/app.js"></script>
</body>
</html>